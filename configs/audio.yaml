sample_rate: 16000
block_ms: 20

# VAD moderat pentru sesiuni (2 = echilibrat)
vad_aggressiveness: 2
silence_ms_to_end: 1500
max_record_seconds: 6
session_idle_seconds: 12
min_valid_seconds: 1.1

# ——— BARGE-IN INTELIGENT (filtrează eco + zgomot, păstrează doar vocea reală) ———
barge_enabled: false
barge_allow_during_tts: true        # dezactivat: TTS se oprește doar pe comanda „stop" (stop keyword detector)
barge_voice_hold_ms: 320
barge_debug_meter: false
barge_debug_interval_ms: 120
barge_voice_drop_ms: 10

barge_min_voice_ms: 550           # cere ~0.5s voce continuă; crește dacă încă prinde eco
barge_min_rms_dbfs: -30             # nivel minim al vocii; difuzoarele rămân de obicei sub -25 dB

barge_highpass_hz: 160               # taie huruit/bas înainte de analiză, păstrează voc
# ZCR = zero-cross rate (ajută să eliminăm zgomote impulsive)
barge_zcr_min: 0.07
barge_zcr_max: 0.28

barge_debounce_ms: 200              # ignoră declanșări repetate în fereastra asta
barge_cooldown_ms: 1000             # cât timp rămâne „latent" după un barge-in valid
barge_arm_after_ms: 1100            # așteaptă atât după startul TTS înainte să re-armă
barge_leak_margin_db: 10.0          # prag = nivel_echo + 10 dB; crește dacă boxele sunt foarte tari
barge_leak_decay_ms: 1800           # cât timp păstrează nivelul eco-ului recent măsurat

stop_keyword:
  enabled: true
  model_path: "voices/stop_keyword.onnx"
  logit_margin: 2.5        # crescut de la 1.2 - ignoră vocea robotului
  prob_threshold: 0.95     # crescut de la 0.85 - necesită probabilitate foarte mare
  hits_required: 1        # crescut de la 1 - necesită 2 detecții consecutive
  debug: false

# ——— Text-based stop (ASR) ———
stop_text_min_voice_ms: 80
stop_text_trigger_ms: 120
stop_text_silence_ms: 150
stop_text_max_ms: 1500
stop_text_overlap_ms: 120
stop_text_debug: true

# ——— OWW Stop (OpenWakeWord-based stop phrases like "shut up") ———
oww_stop:
  enabled: true
  threshold: 0.5
  hits_required: 1
  cooldown_ms: 1500
  debug: false
  models:
    shut_up:
      model_path: "voices/shut__up.onnx"
      label: "shut__up"
      threshold: 0.5

# ——— Audio device & AEC ———
prefer_echo_cancel: true
input_device_hint: "pipewire"        # selectează device-ul PipeWire (default ec_mic)

# AEC mode: system (preferat) | webrtc | off
aec_mode: system                     # PulseAudio module-echo-cancel e deja activ
monitor_device_hint: ""

# Filtre simple din cod (AGC dezactivat pentru a păstra dinamica naturală)
ns: true
agc: false
hpf: true
